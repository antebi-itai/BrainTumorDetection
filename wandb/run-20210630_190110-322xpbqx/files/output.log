> /home/labs/waic/sgvdan/workspace/BrainTumorDetection/experiment.py(68)generate_heatmap()
     66         for idx, images in occluded_loader:
     67           import pdb; pdb.set_trace()
---> 68           occluded_images = images.to(device=self.device)
     69           # Run the model on batched occluded images
     70           self.model(occluded_images)
/home/labs/waic/sgvdan/.conda/envs/segev-workspace/lib/python3.8/site-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /opt/conda/conda-bld/pytorch_1623448234945/work/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  578765 KB |  672461 KB |     851 MB |  293346 KB |
|       from large pool |  576896 KB |  665984 KB |     843 MB |  286597 KB |
|       from small pool |    1869 KB |    7032 KB |       8 MB |    6749 KB |
|---------------------------------------------------------------------------|
| Active memory         |  578765 KB |  672461 KB |     851 MB |  293346 KB |
|       from large pool |  576896 KB |  665984 KB |     843 MB |  286597 KB |
|       from small pool |    1869 KB |    7032 KB |       8 MB |    6749 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  698368 KB |  698368 KB |  698368 KB |       0 B  |
|       from large pool |  690176 KB |  690176 KB |  690176 KB |       0 B  |
|       from small pool |    8192 KB |    8192 KB |    8192 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   25394 KB |   29233 KB |  196338 KB |  170943 KB |
|       from large pool |   25216 KB |   29055 KB |  183551 KB |  158335 KB |
|       from small pool |     178 KB |    2226 KB |   12787 KB |   12608 KB |
|---------------------------------------------------------------------------|
| Allocations           |      41    |      73    |      91    |      50    |
|       from large pool |      16    |      32    |      44    |      28    |
|       from small pool |      25    |      42    |      47    |      22    |
|---------------------------------------------------------------------------|
| Active allocs         |      41    |      73    |      91    |      50    |
|       from large pool |      16    |      32    |      44    |      28    |
|       from small pool |      25    |      42    |      47    |      22    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |      17    |      17    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |       4    |       4    |       4    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |       8    |      28    |      22    |
|       from large pool |       5    |       6    |      16    |      11    |
|       from small pool |       1    |       4    |      12    |      11    |
|===========================================================================|
> /home/labs/waic/sgvdan/workspace/BrainTumorDetection/experiment.py(67)generate_heatmap()
     65         heatmap = []
     66         for idx, images in occluded_loader:
---> 67           import pdb; pdb.set_trace()
     68           occluded_images = images.to(device=self.device)
     69           # Run the model on batched occluded images
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  579533 KB |  705997 KB |    1170 MB |  618948 KB |
|       from large pool |  576896 KB |  698752 KB |    1154 MB |  605451 KB |
|       from small pool |    2637 KB |    7800 KB |      15 MB |   13497 KB |
|---------------------------------------------------------------------------|
| Active memory         |  579533 KB |  705997 KB |    1170 MB |  618948 KB |
|       from large pool |  576896 KB |  698752 KB |    1154 MB |  605451 KB |
|       from small pool |    2637 KB |    7800 KB |      15 MB |   13497 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  724992 KB |  724992 KB |  724992 KB |       0 B  |
|       from large pool |  716800 KB |  716800 KB |  716800 KB |       0 B  |
|       from small pool |    8192 KB |    8192 KB |    8192 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   26674 KB |   34866 KB |  350162 KB |  323487 KB |
|       from large pool |   25216 KB |   33408 KB |  327811 KB |  302595 KB |
|       from small pool |    1458 KB |    2226 KB |   22351 KB |   20892 KB |
|---------------------------------------------------------------------------|
| Allocations           |      42    |      76    |     142    |     100    |
|       from large pool |      16    |      34    |      74    |      58    |
|       from small pool |      26    |      43    |      68    |      42    |
|---------------------------------------------------------------------------|
| Active allocs         |      42    |      76    |     142    |     100    |
|       from large pool |      16    |      34    |      74    |      58    |
|       from small pool |      26    |      43    |      68    |      42    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      18    |      18    |      18    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |       4    |       4    |       4    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      10    |      49    |      42    |
|       from large pool |       5    |       7    |      29    |      24    |
|       from small pool |       2    |       5    |      20    |      18    |
|===========================================================================|
> /home/labs/waic/sgvdan/workspace/BrainTumorDetection/experiment.py(68)generate_heatmap()
     66         for idx, images in occluded_loader:
     67           import pdb; pdb.set_trace()
---> 68           occluded_images = images.to(device=self.device)
     69           # Run the model on batched occluded images
     70           self.model(occluded_images)
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  579533 KB |  706765 KB |    1489 MB |     923 MB |
|       from large pool |  576896 KB |  698752 KB |    1466 MB |     902 MB |
|       from small pool |    2637 KB |    8568 KB |      23 MB |      20 MB |
|---------------------------------------------------------------------------|
| Active memory         |  579533 KB |  706765 KB |    1489 MB |     923 MB |
|       from large pool |  576896 KB |  698752 KB |    1466 MB |     902 MB |
|       from small pool |    2637 KB |    8568 KB |      23 MB |      20 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  727040 KB |  727040 KB |  727040 KB |       0 B  |
|       from large pool |  716800 KB |  716800 KB |  716800 KB |       0 B  |
|       from small pool |   10240 KB |   10240 KB |   10240 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   26674 KB |   35346 KB |  504945 KB |  478270 KB |
|       from large pool |   25216 KB |   33408 KB |  472071 KB |  446855 KB |
|       from small pool |    1458 KB |    2226 KB |   32874 KB |   31415 KB |
|---------------------------------------------------------------------------|
| Allocations           |      42    |      77    |     193    |     151    |
|       from large pool |      16    |      34    |     104    |      88    |
|       from small pool |      26    |      44    |      89    |      63    |
|---------------------------------------------------------------------------|
| Active allocs         |      42    |      77    |     193    |     151    |
|       from large pool |      16    |      34    |     104    |      88    |
|       from small pool |      26    |      44    |      89    |      63    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      19    |      19    |      19    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |       5    |       5    |       5    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      10    |      72    |      64    |
|       from large pool |       5    |       7    |      42    |      37    |
|       from small pool |       3    |       5    |      30    |      27    |
|===========================================================================|
> /home/labs/waic/sgvdan/workspace/BrainTumorDetection/experiment.py(67)generate_heatmap()
     65         heatmap = []
     66         for idx, images in occluded_loader:
---> 67           import pdb; pdb.set_trace()
     68           occluded_images = images.to(device=self.device)
     69           # Run the model on batched occluded images
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  579533 KB |  706765 KB |    1807 MB |    1241 MB |
|       from large pool |  576896 KB |  698752 KB |    1777 MB |    1214 MB |
|       from small pool |    2637 KB |    8568 KB |      30 MB |      27 MB |
|---------------------------------------------------------------------------|
| Active memory         |  579533 KB |  706765 KB |    1807 MB |    1241 MB |
|       from large pool |  576896 KB |  698752 KB |    1777 MB |    1214 MB |
|       from small pool |    2637 KB |    8568 KB |      30 MB |      27 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  727040 KB |  727040 KB |  727040 KB |       0 B  |
|       from large pool |  716800 KB |  716800 KB |  716800 KB |       0 B  |
|       from small pool |   10240 KB |   10240 KB |   10240 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   26674 KB |   35346 KB |  659728 KB |  633053 KB |
|       from large pool |   25216 KB |   33408 KB |  616331 KB |  591115 KB |
|       from small pool |    1458 KB |    2226 KB |   43397 KB |   41938 KB |
|---------------------------------------------------------------------------|
| Allocations           |      42    |      77    |     244    |     202    |
|       from large pool |      16    |      34    |     134    |     118    |
|       from small pool |      26    |      44    |     110    |      84    |
|---------------------------------------------------------------------------|
| Active allocs         |      42    |      77    |     244    |     202    |
|       from large pool |      16    |      34    |     134    |     118    |
|       from small pool |      26    |      44    |     110    |      84    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      19    |      19    |      19    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |       5    |       5    |       5    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      10    |      94    |      87    |
|       from large pool |       5    |       7    |      55    |      50    |
|       from small pool |       2    |       5    |      39    |      37    |
|===========================================================================|
> /home/labs/waic/sgvdan/workspace/BrainTumorDetection/experiment.py(68)generate_heatmap()
     66         for idx, images in occluded_loader:
     67           import pdb; pdb.set_trace()
---> 68           occluded_images = images.to(device=self.device)
     69           # Run the model on batched occluded images
     70           self.model(occluded_images)
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  579533 KB |  706765 KB |    2126 MB |    1560 MB |
|       from large pool |  576896 KB |  698752 KB |    2088 MB |    1525 MB |
|       from small pool |    2637 KB |    8568 KB |      37 MB |      35 MB |
|---------------------------------------------------------------------------|
| Active memory         |  579533 KB |  706765 KB |    2126 MB |    1560 MB |
|       from large pool |  576896 KB |  698752 KB |    2088 MB |    1525 MB |
|       from small pool |    2637 KB |    8568 KB |      37 MB |      35 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  727040 KB |  727040 KB |  727040 KB |       0 B  |
|       from large pool |  716800 KB |  716800 KB |  716800 KB |       0 B  |
|       from small pool |   10240 KB |   10240 KB |   10240 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   26674 KB |   35346 KB |     795 MB |     769 MB |
|       from large pool |   25216 KB |   33408 KB |     742 MB |     718 MB |
|       from small pool |    1458 KB |    2226 KB |      52 MB |      51 MB |
|---------------------------------------------------------------------------|
| Allocations           |      42    |      77    |     295    |     253    |
|       from large pool |      16    |      34    |     164    |     148    |
|       from small pool |      26    |      44    |     131    |     105    |
|---------------------------------------------------------------------------|
| Active allocs         |      42    |      77    |     295    |     253    |
|       from large pool |      16    |      34    |     164    |     148    |
|       from small pool |      26    |      44    |     131    |     105    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      19    |      19    |      19    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |       5    |       5    |       5    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      10    |     117    |     109    |
|       from large pool |       5    |       7    |      68    |      63    |
|       from small pool |       3    |       5    |      49    |      46    |
|===========================================================================|
> /home/labs/waic/sgvdan/workspace/BrainTumorDetection/experiment.py(67)generate_heatmap()
     65         heatmap = []
     66         for idx, images in occluded_loader:
---> 67           import pdb; pdb.set_trace()
     68           occluded_images = images.to(device=self.device)
     69           # Run the model on batched occluded images
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  579533 KB |  706765 KB |    2445 MB |    1879 MB |
|       from large pool |  576896 KB |  698752 KB |    2400 MB |    1836 MB |
|       from small pool |    2637 KB |    8568 KB |      45 MB |      42 MB |
|---------------------------------------------------------------------------|
| Active memory         |  579533 KB |  706765 KB |    2445 MB |    1879 MB |
|       from large pool |  576896 KB |  698752 KB |    2400 MB |    1836 MB |
|       from small pool |    2637 KB |    8568 KB |      45 MB |      42 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  727040 KB |  727040 KB |  727040 KB |       0 B  |
|       from large pool |  716800 KB |  716800 KB |  716800 KB |       0 B  |
|       from small pool |   10240 KB |   10240 KB |   10240 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   26674 KB |   35346 KB |     946 MB |     920 MB |
|       from large pool |   25216 KB |   33408 KB |     883 MB |     859 MB |
|       from small pool |    1458 KB |    2226 KB |      62 MB |      61 MB |
|---------------------------------------------------------------------------|
| Allocations           |      42    |      77    |     346    |     304    |
|       from large pool |      16    |      34    |     194    |     178    |
|       from small pool |      26    |      44    |     152    |     126    |
|---------------------------------------------------------------------------|
| Active allocs         |      42    |      77    |     346    |     304    |
|       from large pool |      16    |      34    |     194    |     178    |
|       from small pool |      26    |      44    |     152    |     126    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      19    |      19    |      19    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |       5    |       5    |       5    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      10    |     139    |     132    |
|       from large pool |       5    |       7    |      81    |      76    |
|       from small pool |       2    |       5    |      58    |      56    |
|===========================================================================|
> /home/labs/waic/sgvdan/workspace/BrainTumorDetection/experiment.py(68)generate_heatmap()
     66         for idx, images in occluded_loader:
     67           import pdb; pdb.set_trace()
---> 68           occluded_images = images.to(device=self.device)
     69           # Run the model on batched occluded images
     70           self.model(occluded_images)
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  579533 KB |  706765 KB |    2763 MB |    2198 MB |
|       from large pool |  576896 KB |  698752 KB |    2711 MB |    2148 MB |
|       from small pool |    2637 KB |    8568 KB |      52 MB |      49 MB |
|---------------------------------------------------------------------------|
| Active memory         |  579533 KB |  706765 KB |    2763 MB |    2198 MB |
|       from large pool |  576896 KB |  698752 KB |    2711 MB |    2148 MB |
|       from small pool |    2637 KB |    8568 KB |      52 MB |      49 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  727040 KB |  727040 KB |  727040 KB |       0 B  |
|       from large pool |  716800 KB |  716800 KB |  716800 KB |       0 B  |
|       from small pool |   10240 KB |   10240 KB |   10240 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   26674 KB |   35346 KB |    1097 MB |    1071 MB |
|       from large pool |   25216 KB |   33408 KB |    1024 MB |     999 MB |
|       from small pool |    1458 KB |    2226 KB |      73 MB |      71 MB |
|---------------------------------------------------------------------------|
| Allocations           |      42    |      77    |     397    |     355    |
|       from large pool |      16    |      34    |     224    |     208    |
|       from small pool |      26    |      44    |     173    |     147    |
|---------------------------------------------------------------------------|
| Active allocs         |      42    |      77    |     397    |     355    |
|       from large pool |      16    |      34    |     224    |     208    |
|       from small pool |      26    |      44    |     173    |     147    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      19    |      19    |      19    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |       5    |       5    |       5    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      10    |     162    |     154    |
|       from large pool |       5    |       7    |      94    |      89    |
|       from small pool |       3    |       5    |      68    |      65    |
|===========================================================================|
> /home/labs/waic/sgvdan/workspace/BrainTumorDetection/experiment.py(67)generate_heatmap()
     65         heatmap = []
     66         for idx, images in occluded_loader:
---> 67           import pdb; pdb.set_trace()
     68           occluded_images = images.to(device=self.device)
     69           # Run the model on batched occluded images
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  579533 KB |  706765 KB |    3082 MB |    2516 MB |
|       from large pool |  576896 KB |  698752 KB |    3022 MB |    2459 MB |
|       from small pool |    2637 KB |    8568 KB |      59 MB |      57 MB |
|---------------------------------------------------------------------------|
| Active memory         |  579533 KB |  706765 KB |    3082 MB |    2516 MB |
|       from large pool |  576896 KB |  698752 KB |    3022 MB |    2459 MB |
|       from small pool |    2637 KB |    8568 KB |      59 MB |      57 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  727040 KB |  727040 KB |  727040 KB |       0 B  |
|       from large pool |  716800 KB |  716800 KB |  716800 KB |       0 B  |
|       from small pool |   10240 KB |   10240 KB |   10240 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   26674 KB |   35346 KB |    1248 MB |    1222 MB |
|       from large pool |   25216 KB |   33408 KB |    1165 MB |    1140 MB |
|       from small pool |    1458 KB |    2226 KB |      83 MB |      82 MB |
|---------------------------------------------------------------------------|
| Allocations           |      42    |      77    |     448    |     406    |
|       from large pool |      16    |      34    |     254    |     238    |
|       from small pool |      26    |      44    |     194    |     168    |
|---------------------------------------------------------------------------|
| Active allocs         |      42    |      77    |     448    |     406    |
|       from large pool |      16    |      34    |     254    |     238    |
|       from small pool |      26    |      44    |     194    |     168    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      19    |      19    |      19    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |       5    |       5    |       5    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      10    |     184    |     177    |
|       from large pool |       5    |       7    |     107    |     102    |
|       from small pool |       2    |       5    |      77    |      75    |
|===========================================================================|